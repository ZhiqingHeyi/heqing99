import{_ as We,u as Je,z as Ke,l as Qe,r as p,m as N,b as re,n as ie,k as Xe,x as ue,E as i,y as et,d as u,C as tt,o as g,c as P,f as t,w as a,p as E,e as d,t as f,s as A,j as S,D as $,G as ot,H as lt,I as at,J as st,i as v,h as L,K as nt,L as W,v as de}from"./index-27530dd5.js";const rt={class:"profile-container"},it={class:"user-avatar"},ut={class:"user-name"},dt={class:"user-points"},ct={class:"user-total-spent"},pt={key:0,class:"upgrade-progress"},mt={key:0},gt={class:"section-header"},ft={key:1},vt={class:"member-benefits"},_t={key:2},ht={class:"section-header"},bt={key:0,class:"loading-container"},yt={key:1,class:"bookings-list"},wt={key:3,class:"pagination-container"},kt={key:3},Pt={key:1},It={key:0,class:"pagination-container"},St={key:4},xt={__name:"Profile",setup(Nt){const F=o=>{if(!o)return"-";try{const e=new Date(o);if(isNaN(e.getTime()))return"无效日期";const s=e.getFullYear(),m=(e.getMonth()+1).toString().padStart(2,"0"),_=e.getDate().toString().padStart(2,"0");return`${s}-${m}-${_}`}catch(e){return console.error("Error formatting date:",o,e),"格式化错误"}},ce=o=>{if(!o)return"-";try{const e=new Date(o);if(isNaN(e.getTime()))return"无效日期时间";const s=F(o);if(s.includes("无效")||s.includes("错误"))return s;const m=e.getHours().toString().padStart(2,"0"),_=e.getMinutes().toString().padStart(2,"0");return`${s} ${m}:${_}`}catch(e){return console.error("Error formatting datetime:",o,e),"格式化错误"}},pe=o=>{switch(o?o.toLowerCase():""){case"earn":return"获得";case"redeem":return"兑换";case"expire":return"过期";case"adjust":return"调整";default:return"未知"}};console.log("Profile.vue组件加载");const U=Je(),me=Ke(),H=Qe(),I=p(!1);p(!1);const b=p("profile");p("all"),p(1),p(10),p(0);const ge=p(!1),fe=p(null),ve=()=>{I.value=!I.value},_e=N({name:[{required:!0,message:"请输入真实姓名",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号码",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号码",trigger:"blur"}],email:[{type:"email",message:"请输入有效的邮箱地址",trigger:["blur","change"]}]}),J=p([]),K=()=>{U.push("/booking")},he=p(!1),be=p(!1);re(()=>localStorage.getItem("userName")||""),re(()=>localStorage.getItem("userLevel")||"普通用户"),N({});const n=N({userName:localStorage.getItem("userName")||"用户名",level:localStorage.getItem("userLevel")||"普通用户",points:parseInt(localStorage.getItem("userPoints")||"0"),totalSpent:parseInt(localStorage.getItem("userTotalSpent")||"0"),nextLevel:""}),Q=()=>{const o=n.level,e=n.totalSpent;o==="普通用户"?n.nextLevel="铜牌会员（再消费¥"+Math.max(0,1500-e)+"）":o==="铜牌会员"?n.nextLevel="银牌会员（再消费¥"+Math.max(0,5e3-e)+"）":o==="银牌会员"?n.nextLevel="金牌会员（再消费¥"+Math.max(0,1e4-e)+"）":o==="金牌会员"?n.nextLevel="钻石会员（再消费¥"+Math.max(0,3e4-e)+"）":o==="钻石会员"?n.nextLevel="已是最高等级":n.nextLevel=""};ie(()=>n.totalSpent,()=>{Q()});const r=N({userName:n.userName,name:"张三",phone:"13812345678",email:"zhangsan@example.com",birthday:"",gender:"male"}),z=p(null),y=N({oldPassword:"",newPassword:"",confirmPassword:""}),ye={oldPassword:[{required:!0,message:"请输入当前密码",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,message:"密码长度不能少于6个字符",trigger:"blur"},{validator:(o,e,s)=>{e===""?s(new Error("请输入密码")):(y.confirmPassword!==""&&z.value.validateField("confirmPassword"),s())},trigger:"blur"}],confirmPassword:[{required:!0,message:"请再次输入密码",trigger:"blur"},{validator:(o,e,s)=>{e===""?s(new Error("请再次输入密码")):e!==y.newPassword?s(new Error("两次输入密码不一致!")):s()},trigger:"blur"}]},V=N({promotions:!0,bookingSms:!0,pointsNotifications:!0});p([]),p([]);const we=o=>({pending:"warning",confirmed:"primary","checked-in":"success",completed:"info",cancelled:"danger"})[o?o.toLowerCase():""],ke=o=>({pending:"待确认",confirmed:"已确认","checked-in":"已入住",completed:"已完成",cancelled:"已取消"})[o?o.toLowerCase():""]||"未知状态",Pe=o=>{console.log(`%c[Menu Click] Received index: ${o}`,"color: blue; font-weight: bold;"),b.value=o,console.log(`%c[Menu Click] activeMenu is now: ${b.value}`,"color: blue;")},Ie=async()=>{console.log("%c[fetchUserInfo] Attempting to fetch user info...","color: purple;");try{const o=H.userId;if(!o){console.error("[fetchUserInfo] User ID not found in auth store."),i.error("用户未登录或会话已过期，请重新登录"),H.logout(),U.push("/login");return}const e=await E.getUserInfo(o);if(console.log("[fetchUserInfo] API Response:",e),e&&e.success&&e.data){const s=e.data;n.userName=s.username||"未知用户",n.level=Ae(s.memberLevel),n.points=s.points??0,n.totalSpent=s.totalSpent??0,Q(),Object.assign(r,{userName:s.username||"",name:s.name||"",phone:s.phone||"",email:s.email||"",birthday:s.birthday?s.birthday:null,gender:s.gender||""}),console.log("[fetchUserInfo] User info updated:",n,r),localStorage.setItem("userName",n.userName),localStorage.setItem("userLevel",n.level),localStorage.setItem("userPoints",String(n.points)),localStorage.setItem("userTotalSpent",String(n.totalSpent))}else console.error("[fetchUserInfo] Failed to fetch user info or data missing:",(e==null?void 0:e.message)||"响应结构不符"),i.error((e==null?void 0:e.message)||"获取用户信息失败")}catch(o){console.error("[fetchUserInfo] Error fetching user info:",o),i.error(o.message||"获取用户信息时发生错误")}},Se=async()=>{let o=null;try{if(!r.userName.trim()||!r.name.trim()||!r.phone.trim()){i.warning("用户名、姓名和手机号不能为空");return}if(!/^1[3-9]\d{9}$/.test(r.phone)){i.warning("请输入有效的手机号");return}if(r.email&&!/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/.test(r.email)){i.warning("请输入有效的邮箱地址");return}if(o=localStorage.getItem("userId"),!o){i.error("未找到用户ID，请重新登录");return}const s={username:r.userName,name:r.name,phone:r.phone,email:r.email,gender:r.gender,birthday:r.birthday?new Date(r.birthday).toISOString().split("T")[0]:null},m=W.service({lock:!0,text:"保存中...",background:"rgba(255, 255, 255, 0.7)"});try{const _=await E.updateUserInfo(o,s);_.success?(i.success("信息更新成功"),localStorage.setItem("userName",s.username),localStorage.setItem("userRealName",s.name),localStorage.setItem("userPhone",s.phone),localStorage.setItem("userEmail",s.email||""),localStorage.setItem("userGender",s.gender||"unknown"),localStorage.setItem("userBirthday",s.birthday||""),n.userName=s.username,r.userName=s.username,r.name=s.name,r.phone=s.phone,r.email=s.email,r.gender=s.gender,r.birthday=s.birthday,I.value=!1):i.error(_.message||"更新失败，请稍后重试")}catch(_){console.error("更新用户信息失败:",_),i.error(_.message||"更新失败，请稍后重试")}finally{m.close()}}catch(e){console.error("保存用户信息出错:",e),i.error("操作出错，请重试")}},xe=async()=>{z.value&&await z.value.validate(async o=>{if(o){const e=localStorage.getItem("userId");if(!e){i.error("未找到用户ID，请重新登录");return}const s=W.service({lock:!0,text:"提交中...",background:"rgba(255, 255, 255, 0.7)"});try{const m=await E.changePassword(e,{oldPassword:y.oldPassword,newPassword:y.newPassword});m.success?(i.success("密码修改成功"),y.oldPassword="",y.newPassword="",y.confirmPassword="",z.value.resetFields()):i.error(m.message||"密码修改失败，请稍后重试")}catch(m){console.error("修改密码失败:",m),i.error(m.message||"密码修改失败，请稍后重试")}finally{s.close()}}})},Ne=()=>{i.success("通知设置保存成功")},Ce=async()=>{try{await de.confirm("确定要退出登录吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})}catch(o){o!=="cancel"&&i.info("取消退出");return}try{await E.logout()}catch(o){console.error("API退出登录失败:",o)}H.logout(),i.success("已退出登录"),U.push("/")},Ve=o=>{console.log("查看预订详情 ID:",o),o?U.push({name:"user-booking-detail",params:{id:o}}):console.error("Invalid booking ID for details view")},ze=o=>["PENDING","CONFIRMED"].includes(o),Re=async o=>{try{await de.confirm("确定要取消该预订吗? 取消后可能无法恢复。","取消确认",{confirmButtonText:"确定取消",cancelButtonText:"再想想",type:"warning",confirmButtonClass:"el-button--danger"});const e=W.service({target:".bookings-list",text:"正在取消..."});try{const s=await ue.cancelReservation(o);s&&s.success?(i.success("预订已取消"),M()):i.error((s==null?void 0:s.message)||"取消预订失败")}catch(s){console.error("取消预订API调用失败:",s),i.error("取消预订时发生错误: "+((s==null?void 0:s.message)||"请稍后重试"))}finally{e.close()}}catch(e){e==="cancel"&&i.info("取消操作已取消")}},Me=o=>{o?(b.value="bookings",i.info(`已切换到预订列表，请查找预订号 #${o}`)):console.warn("viewRelatedBooking called with invalid bookingId")},X=o=>({普通用户:"level-normal",铜牌会员:"level-bronze",银牌会员:"level-silver",金牌会员:"level-gold",钻石会员:"level-diamond"})[o]||"level-normal",Le=()=>n.level==="普通用户"?Math.min(100,n.totalSpent/1500*100):n.level==="铜牌会员"?Math.min(100,(n.totalSpent-1500)/(5e3-1500)*100):n.level==="银牌会员"?Math.min(100,(n.totalSpent-5e3)/(1e4-5e3)*100):n.level==="金牌会员"?Math.min(100,(n.totalSpent-1e4)/(3e4-1e4)*100):100,Ue=()=>[{level:"普通用户",discount:"无折扣",pointRate:"无积分",prepay:"需全额或30%预付",cancel:"提前24小时可免费取消",threshold:"注册即可"},{level:"铜牌会员",discount:"98折",pointRate:"1元=1积分",prepay:"可到店支付",cancel:"提前12小时可免费取消",threshold:"累计消费满1500元"},{level:"银牌会员",discount:"95折",pointRate:"1元=1.2积分",prepay:"可免预付金",cancel:"提前6小时可免费取消",threshold:"累计消费满5000元"},{level:"金牌会员",discount:"9折",pointRate:"1元=1.5积分",prepay:"免预付金",cancel:"可随时免费取消",threshold:"累计消费满10000元"},{level:"钻石会员",discount:"8.5折",pointRate:"1元=2积分",prepay:"免预付金",cancel:"可免费取消+延迟退房",threshold:"累计消费满30000元"}],R=p([]),O=p(!1),w=N({current:1,size:5,total:0}),D=p([]),q=p(!1),k=N({current:1,size:10,total:0}),ee=p(["password"]);Xe(()=>{Ie(),J.value=Ue();const o=me.query.tab;o&&["profile","bookings","points","settings"].includes(o)?b.value=o:b.value="profile",b.value==="bookings"?M():b.value==="points"&&B()}),ie(b,(o,e)=>{o==="bookings"?M():o==="points"&&B()});const M=async()=>{O.value=!0;const o={page:w.current,pageSize:w.size};try{const e=await ue.getUserReservations(o.page,o.pageSize);if(e&&e.success&&e.data){const s=e.data.content||[],m=e.data.totalElements||0;R.value=s,w.total=m}else console.error("[Profile.vue fetchUserBookings] API call failed or returned unexpected structure:",e),i.error((e==null?void 0:e.message)||"获取预订记录失败"),R.value=[],w.total=0}catch(e){console.error("[Profile.vue fetchUserBookings] API call threw an error:",e),i.error((e==null?void 0:e.message)||"获取预订记录时发生错误"),R.value=[],w.total=0}finally{O.value=!1}},De=o=>{w.size=o,w.current=1,M()},Be=o=>{w.current=o,M()},B=async()=>{q.value=!0;const o={page:k.current,pageSize:k.size};try{const e=await et.getPointsHistory(o.page,o.pageSize);if(e&&e.success&&e.data){const s=e.data.list||[],m=e.data.total||0;D.value=s,k.total=m}else console.error("[Profile.vue fetchPointsHistory] API call failed or returned unexpected structure:",e),i.error((e==null?void 0:e.message)||"获取积分记录失败"),D.value=[],k.total=0}catch(e){console.error("[Profile.vue fetchPointsHistory] API call threw an error:",e),i.error((e==null?void 0:e.message)||"获取积分记录时发生错误"),D.value=[],k.total=0}finally{q.value=!1}},Te=o=>{k.size=o,k.current=1,B()},Ee=o=>{k.current=o,B()},Ae=o=>({REGULAR:"普通用户",BRONZE:"铜牌会员",SILVER:"银牌会员",GOLD:"金牌会员",DIAMOND:"钻石会员"})[o]||"普通用户";return(o,e)=>{const s=u("el-avatar"),m=u("el-progress"),_=u("el-icon"),T=u("el-menu-item"),$e=u("el-menu"),x=u("el-button"),te=u("el-card"),oe=u("el-col"),C=u("el-input"),h=u("el-form-item"),Fe=u("el-date-picker"),j=u("el-option"),He=u("el-select"),G=u("el-form"),c=u("el-table-column"),Y=u("el-table"),Oe=u("el-skeleton"),le=u("el-tag"),qe=u("el-empty"),ae=u("el-pagination"),je=u("el-link"),se=u("el-collapse-item"),Z=u("el-switch"),Ge=u("el-collapse"),Ye=u("el-row"),Ze=tt("loading");return g(),P("div",rt,[t(Ye,{gutter:20},{default:a(()=>[t(oe,{xs:24,sm:8,md:6,lg:5},{default:a(()=>[t(te,{class:"user-card"},{default:a(()=>[d("div",it,[t(s,{size:100,src:"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png"})]),d("h3",ut,f(n.userName||"用户名"),1),d("div",{class:A(["member-badge",X(n.level)])},f(n.level),3),d("p",dt,"积分: "+f(n.points||0),1),d("p",ct,"累计消费: ¥"+f(n.totalSpent||0),1),n.level!=="钻石会员"?(g(),P("div",pt,[d("span",null,"距离"+f(n.nextLevel),1),t(m,{percentage:Le(),"stroke-width":8,"show-text":!1},null,8,["percentage"])])):S("",!0),t($e,{class:"profile-menu","default-active":b.value,onSelect:Pe},{default:a(()=>[t(T,{index:"profile"},{default:a(()=>[t(_,null,{default:a(()=>[t($(ot))]),_:1}),e[13]||(e[13]=d("span",null,"个人信息",-1))]),_:1}),t(T,{index:"bookings"},{default:a(()=>[t(_,null,{default:a(()=>[t($(lt))]),_:1}),e[14]||(e[14]=d("span",null,"我的预订",-1))]),_:1}),t(T,{index:"points"},{default:a(()=>[t(_,null,{default:a(()=>[t($(at))]),_:1}),e[15]||(e[15]=d("span",null,"积分记录",-1))]),_:1}),t(T,{index:"settings"},{default:a(()=>[t(_,null,{default:a(()=>[t($(st))]),_:1}),e[16]||(e[16]=d("span",null,"账号设置",-1))]),_:1})]),_:1},8,["default-active"]),t(x,{class:"logout-btn",type:"danger",onClick:Ce},{default:a(()=>e[17]||(e[17]=[v("退出登录")])),_:1})]),_:1})]),_:1}),t(oe,{xs:24,sm:16,md:18,lg:19},{default:a(()=>[t(te,{class:"content-card"},{default:a(()=>[b.value==="profile"?(g(),P("div",mt,[d("div",gt,[e[18]||(e[18]=d("h2",null,"个人信息",-1)),t(x,{type:"primary",size:"small",class:A(I.value?"btn-cancel-style":"btn-edit-style"),onClick:ve},{default:a(()=>[v(f(I.value?"取消":"编辑"),1)]),_:1},8,["class"])]),t(G,{model:r,rules:_e,ref_key:"userFormRef",ref:fe,"label-width":"100px",class:"user-form"},{default:a(()=>[t(h,{label:"用户名"},{default:a(()=>[t(C,{modelValue:r.userName,"onUpdate:modelValue":e[0]||(e[0]=l=>r.userName=l),disabled:""},null,8,["modelValue"])]),_:1}),t(h,{label:"真实姓名",prop:"name"},{default:a(()=>[t(C,{modelValue:r.name,"onUpdate:modelValue":e[1]||(e[1]=l=>r.name=l),disabled:!I.value},null,8,["modelValue","disabled"])]),_:1}),t(h,{label:"手机号码",prop:"phone"},{default:a(()=>[t(C,{modelValue:r.phone,"onUpdate:modelValue":e[2]||(e[2]=l=>r.phone=l),disabled:!I.value},null,8,["modelValue","disabled"])]),_:1}),t(h,{label:"邮箱",prop:"email"},{default:a(()=>[t(C,{modelValue:r.email,"onUpdate:modelValue":e[3]||(e[3]=l=>r.email=l),disabled:!I.value},null,8,["modelValue","disabled"])]),_:1}),t(h,{label:"生日"},{default:a(()=>[t(Fe,{modelValue:r.birthday,"onUpdate:modelValue":e[4]||(e[4]=l=>r.birthday=l),type:"date",placeholder:"选择日期",disabled:!I.value,style:{width:"100%"},"value-format":"YYYY-MM-DD"},null,8,["modelValue","disabled"])]),_:1}),t(h,{label:"性别"},{default:a(()=>[t(He,{modelValue:r.gender,"onUpdate:modelValue":e[5]||(e[5]=l=>r.gender=l),placeholder:"请选择",disabled:!I.value,style:{width:"100%"}},{default:a(()=>[t(j,{label:"男",value:"男"}),t(j,{label:"女",value:"女"}),t(j,{label:"不详",value:"不详"})]),_:1},8,["modelValue","disabled"])]),_:1}),I.value?(g(),L(h,{key:0},{default:a(()=>[t(x,{type:"primary",onClick:Se,loading:ge.value,class:"btn-save-style"},{default:a(()=>e[19]||(e[19]=[v("保存")])),_:1},8,["loading"])]),_:1})):S("",!0)]),_:1},8,["model","rules"])])):S("",!0),b.value==="profile"?(g(),P("div",ft,[e[20]||(e[20]=d("div",{class:"section-header"},[d("h2",null,"会员特权")],-1)),d("div",vt,[t(Y,{data:J.value,style:{width:"100%"},class:"benefits-table"},{default:a(()=>[t(c,{prop:"level",label:"会员等级",width:"120"},{default:a(({row:l})=>[d("div",{class:A(["level-tag",X(l.level)])},f(l.level),3)]),_:1}),t(c,{prop:"discount",label:"折扣优惠",width:"100"}),t(c,{prop:"pointRate",label:"积分比例",width:"100"}),t(c,{prop:"prepay",label:"预付政策",width:"150"}),t(c,{prop:"cancel",label:"取消政策"}),t(c,{prop:"threshold",label:"升级条件",width:"180"})]),_:1},8,["data"])])])):S("",!0),b.value==="bookings"?(g(),P("div",_t,[d("div",ht,[e[22]||(e[22]=d("h2",null,"我的预订",-1)),t(x,{type:"primary",size:"small",onClick:K,class:"btn-edit-style"},{default:a(()=>e[21]||(e[21]=[v(" 新增预订 ")])),_:1})]),O.value?(g(),P("div",bt,[t(Oe,{rows:5,animated:""})])):R.value.length>0?(g(),P("div",yt,[t(Y,{data:R.value,style:{width:"100%"}},{default:a(()=>[t(c,{prop:"id",label:"预订号",width:"100"}),t(c,{prop:"roomTypeName",label:"房间类型"}),t(c,{prop:"checkInTime",label:"入住日期",width:"120"},{default:a(({row:l})=>[v(f(F(l.checkInTime)),1)]),_:1}),t(c,{prop:"checkOutTime",label:"离店日期",width:"120"},{default:a(({row:l})=>[v(f(F(l.checkOutTime)),1)]),_:1}),t(c,{prop:"roomCount",label:"数量",width:"60"}),t(c,{prop:"totalPrice",label:"总价",width:"100"},{default:a(({row:l})=>[v("¥"+f(l.totalPrice),1)]),_:1}),t(c,{prop:"status",label:"状态",width:"100"},{default:a(({row:l})=>[t(le,{type:we(l.status)},{default:a(()=>[v(f(ke(l.status)),1)]),_:2},1032,["type"])]),_:1}),t(c,{label:"操作",width:"150",fixed:"right"},{default:a(({row:l})=>[ze(l.status)?(g(),L(x,{key:0,type:"danger",link:"",size:"small",onClick:ne=>Re(l.id)},{default:a(()=>e[23]||(e[23]=[v("取消")])),_:2},1032,["onClick"])):S("",!0),t(x,{type:"primary",link:"",size:"small",onClick:ne=>Ve(l.id)},{default:a(()=>e[24]||(e[24]=[v("详情")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])])):(g(),L(qe,{key:2,description:"您还没有相关预订记录","image-size":150,class:"no-bookings"},{default:a(()=>[t(x,{type:"primary",onClick:K},{default:a(()=>e[25]||(e[25]=[v("立即预订")])),_:1})]),_:1})),w.total>0?(g(),P("div",wt,[t(ae,{onSizeChange:De,onCurrentChange:Be,"current-page":w.current,"page-sizes":[5,10,20],"page-size":w.size,layout:"total, sizes, prev, pager, next, jumper",total:w.total,background:""},null,8,["current-page","page-size","total"])])):S("",!0)])):S("",!0),b.value==="points"?(g(),P("div",kt,[e[26]||(e[26]=d("div",{class:"section-header"},[d("h2",null,"积分记录")],-1)),nt((g(),L(Y,{data:D.value,style:{width:"100%"},class:"points-table"},{default:a(()=>[t(c,{prop:"createTime",label:"日期",width:"180"},{default:a(({row:l})=>[v(f(ce(l.createTime)),1)]),_:1}),t(c,{prop:"type",label:"类型",width:"100"},{default:a(({row:l})=>[t(le,{type:l.type.toLowerCase()==="earn"?"success":l.type.toLowerCase()==="redeem"?"warning":"info"},{default:a(()=>[v(f(pe(l.type)),1)]),_:2},1032,["type"])]),_:1}),t(c,{prop:"points",label:"积分变化",width:"100"},{default:a(({row:l})=>[d("span",{class:A(l.points>0?"points-up":"points-down")},f(l.points>0?"+":"")+f(l.points),3)]),_:1}),t(c,{prop:"balance",label:"当前积分",width:"100"}),t(c,{prop:"description",label:"描述"}),t(c,{prop:"orderNo",label:"关联单号",width:"120"},{default:a(({row:l})=>[l.orderNo&&l.type.toLowerCase()==="earn"?(g(),L(je,{key:0,onClick:ne=>Me(l.orderNo.startsWith("R")?l.orderNo.substring(1):l.orderNo)},{default:a(()=>[v(" #"+f(l.orderNo.startsWith("R")?l.orderNo.substring(1):l.orderNo),1)]),_:2},1032,["onClick"])):l.orderNo?(g(),P("span",Pt," #"+f(l.orderNo.startsWith("R")?l.orderNo.substring(1):l.orderNo),1)):S("",!0)]),_:1})]),_:1},8,["data"])),[[Ze,q.value]]),k.total>0?(g(),P("div",It,[t(ae,{onSizeChange:Te,onCurrentChange:Ee,"current-page":k.current,"page-sizes":[10,20,50],"page-size":k.size,layout:"total, sizes, prev, pager, next, jumper",total:k.total,background:""},null,8,["current-page","page-size","total"])])):S("",!0)])):S("",!0),b.value==="settings"?(g(),P("div",St,[e[29]||(e[29]=d("div",{class:"section-header"},[d("h2",null,"账号设置")],-1)),t(Ge,{modelValue:ee.value,"onUpdate:modelValue":e[12]||(e[12]=l=>ee.value=l)},{default:a(()=>[t(se,{title:"修改密码",name:"password"},{default:a(()=>[t(G,{model:y,rules:ye,ref_key:"passwordFormRef",ref:z,"label-width":"100px",style:{"max-width":"400px","margin-top":"20px"}},{default:a(()=>[t(h,{label:"当前密码",prop:"oldPassword"},{default:a(()=>[t(C,{modelValue:y.oldPassword,"onUpdate:modelValue":e[6]||(e[6]=l=>y.oldPassword=l),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),t(h,{label:"新密码",prop:"newPassword"},{default:a(()=>[t(C,{modelValue:y.newPassword,"onUpdate:modelValue":e[7]||(e[7]=l=>y.newPassword=l),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),t(h,{label:"确认新密码",prop:"confirmPassword"},{default:a(()=>[t(C,{modelValue:y.confirmPassword,"onUpdate:modelValue":e[8]||(e[8]=l=>y.confirmPassword=l),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),t(h,null,{default:a(()=>[t(x,{type:"primary",onClick:xe,loading:he.value,class:"btn-edit-style"},{default:a(()=>e[27]||(e[27]=[v(" 确认修改 ")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1}),t(se,{title:"订阅设置",name:"notifications"},{default:a(()=>[t(G,{"label-width":"200px",style:{"max-width":"500px","margin-top":"20px"}},{default:a(()=>[t(h,{label:"接收促销邮件"},{default:a(()=>[t(Z,{modelValue:V.promotions,"onUpdate:modelValue":e[9]||(e[9]=l=>V.promotions=l)},null,8,["modelValue"])]),_:1}),t(h,{label:"接收预订确认短信"},{default:a(()=>[t(Z,{modelValue:V.bookingSms,"onUpdate:modelValue":e[10]||(e[10]=l=>V.bookingSms=l)},null,8,["modelValue"])]),_:1}),t(h,{label:"接收积分变动通知"},{default:a(()=>[t(Z,{modelValue:V.pointsNotifications,"onUpdate:modelValue":e[11]||(e[11]=l=>V.pointsNotifications=l)},null,8,["modelValue"])]),_:1}),t(h,null,{default:a(()=>[t(x,{type:"primary",onClick:Ne,loading:be.value,class:"btn-edit-style"},{default:a(()=>e[28]||(e[28]=[v(" 保存设置 ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])):S("",!0)]),_:1})]),_:1})]),_:1})])}}},Rt=We(xt,[["__scopeId","data-v-b92ef0f8"]]);export{Rt as default};
