import{_ as M,z as x,r as m,b as B,k as T,o as d,h as C,w as l,D as o,x as F,E as S,e as k,c as f,f as s,M as $,N as b,O as i,i as c,t as r,P,Q as I,R}from"./index-27530dd5.js";const L={key:0,class:"loading-state"},V={key:1,class:"error-state"},O={key:2,class:"detail-content"},q={key:3},z={__name:"BookingDetail",setup(A){const v=a=>{if(!a)return"-";try{const e=new Date(a);if(isNaN(e.getTime()))return"无效日期";const u=e.getFullYear(),p=(e.getMonth()+1).toString().padStart(2,"0"),_=e.getDate().toString().padStart(2,"0");return`${u}-${p}-${_}`}catch(e){return console.error("Error formatting date:",a,e),"格式化错误"}},y=a=>{if(!a)return"-";try{const e=new Date(a);if(isNaN(e.getTime()))return"无效日期时间";const u=v(a);if(u.includes("无效")||u.includes("错误"))return u;const p=e.getHours().toString().padStart(2,"0"),_=e.getMinutes().toString().padStart(2,"0");return`${u} ${p}:${_}`}catch(e){return console.error("Error formatting datetime:",a,e),"格式化错误"}},D=a=>({pending:"warning",confirmed:"primary","checked-in":"success",completed:"info",cancelled:"danger"})[a?a.toLowerCase():""],E=a=>({pending:"待确认",confirmed:"已确认","checked-in":"已入住",completed:"已完成",cancelled:"已取消"})[a?a.toLowerCase():""]||"未知状态",w=x(),t=m(null),g=m(!0),n=m(""),h=B(()=>w.params.id),N=async()=>{var a;if(g.value=!0,n.value="",t.value=null,!h.value){n.value="无效的预订ID",g.value=!1;return}try{const e=await F.getReservationDetail(h.value);e&&e.success&&e.data?(t.value=e.data,console.log("Fetched booking detail:",t.value),t.value.roomCount||console.warn("Fetched booking detail is missing roomCount."),t.value.contactName||console.warn("Fetched booking detail is missing contactName."),t.value.contactPhone||console.warn("Fetched booking detail is missing contactPhone.")):(n.value=(e==null?void 0:e.message)||"获取预订详情失败",console.error("Failed to fetch booking detail or invalid response structure:",e),e&&e.code===404&&(n.value="未找到指定的预订记录"))}catch(e){console.error("Error fetching booking details:",e),n.value=(e==null?void 0:e.message)||"加载预订详情时发生错误",((a=e==null?void 0:e.response)==null?void 0:a.status)===404?n.value="未找到指定的预订记录":e!=null&&e.message?n.value=`加载失败: ${e.message}`:n.value="加载预订详情时发生未知错误",S.error(n.value)}finally{g.value=!1}};return T(()=>{N()}),(a,e)=>(d(),C(o(R),{class:"booking-detail-card"},{header:l(()=>e[0]||(e[0]=[k("div",{class:"card-header"},[k("span",null,"预订详情")],-1)])),default:l(()=>[g.value?(d(),f("div",L,[s(o($),{rows:6,animated:""})])):n.value?(d(),f("div",V,[s(o(b),{description:n.value},null,8,["description"])])):t.value?(d(),f("div",O,[s(o(I),{column:2,border:""},{default:l(()=>[s(o(i),{label:"预订号"},{default:l(()=>[c(r(t.value.id),1)]),_:1}),s(o(i),{label:"状态"},{default:l(()=>[s(o(P),{type:D(t.value.status)},{default:l(()=>[c(r(E(t.value.status)),1)]),_:1},8,["type"])]),_:1}),s(o(i),{label:"房间类型"},{default:l(()=>[c(r(t.value.roomTypeName||"-"),1)]),_:1}),s(o(i),{label:"房间数量"},{default:l(()=>[c(r(t.value.roomCount)+" 间",1)]),_:1}),s(o(i),{label:"入住日期"},{default:l(()=>[c(r(v(t.value.checkInTime)),1)]),_:1}),s(o(i),{label:"离店日期"},{default:l(()=>[c(r(v(t.value.checkOutTime)),1)]),_:1}),s(o(i),{label:"总价"},{default:l(()=>{var u;return[c("¥ "+r(((u=t.value.totalPrice)==null?void 0:u.toFixed(2))||"0.00"),1)]}),_:1}),s(o(i),{label:"预订时间"},{default:l(()=>[c(r(y(t.value.createTime)),1)]),_:1}),s(o(i),{label:"联系人姓名"},{default:l(()=>[c(r(t.value.contactName||"-"),1)]),_:1}),s(o(i),{label:"联系电话"},{default:l(()=>[c(r(t.value.contactPhone||"-"),1)]),_:1}),s(o(i),{label:"特殊要求",span:2},{default:l(()=>[c(r(t.value.specialRequests||"无"),1)]),_:1})]),_:1})])):(d(),f("div",q,[s(o(b),{description:"无法加载预订详情"})]))]),_:1}))}},Q=M(z,[["__scopeId","data-v-258b6878"]]);export{Q as default};
