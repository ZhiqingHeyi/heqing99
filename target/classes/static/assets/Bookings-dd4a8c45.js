import{_ as de,i as I,d as m,r as s,s as ie,o as k,c as P,b as C,a as l,w as o,E as f,g as d,v as me,f as V,t as pe,x as R,F as ce,e as ge,y as M}from"./index-2ad3cb15.js";const fe={class:"bookings-container"},be={class:"page-header"},ke={class:"pagination-container"},ve={class:"dialog-footer"},ye={class:"dialog-footer"},Ve={__name:"Bookings",setup(_e){const u=I({bookingNo:"",customerName:"",phone:"",status:"",dateRange:null}),N=m(!1),O=m([{bookingNo:"BK20240331001",customerName:"张三",phone:"13800138000",roomType:"标准双人间",roomNumber:"203",checkInDate:"2024-03-31",checkOutDate:"2024-04-02",status:"confirmed"}]),h=m(1),T=m(10),j=m(100),v=m(!1),w=m("add"),U=m(null),n=I({customerName:"",phone:"",idCard:"",roomType:"",dateRange:null,roomCount:1,specialRequests:""}),_=m(!1),B=m(null),p=I({roomNumber:"",deposit:500,remarks:""}),L=m([{number:"201",type:"double"},{number:"202",type:"double"},{number:"203",type:"double"}]),A={customerName:[{required:!0,message:"请输入客户姓名",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号",trigger:"blur"}],idCard:[{required:!0,message:"请输入身份证号",trigger:"blur"},{pattern:/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/,message:"请输入正确的身份证号",trigger:"blur"}],roomType:[{required:!0,message:"请选择房间类型",trigger:"change"}],dateRange:[{required:!0,message:"请选择入住日期",trigger:"change"}],roomCount:[{required:!0,message:"请选择房间数量",trigger:"change"}]},K={roomNumber:[{required:!0,message:"请选择房间号",trigger:"change"}],deposit:[{required:!0,message:"请输入押金金额",trigger:"blur"}]},X=a=>({pending:"warning",confirmed:"primary","checked-in":"success",cancelled:"info",completed:""})[a],G=a=>({pending:"待确认",confirmed:"已确认","checked-in":"已入住",cancelled:"已取消",completed:"已完成"})[a],S=()=>{h.value=1,y()},H=()=>{Object.keys(u).forEach(a=>{u[a]=""}),u.dateRange=null,S()},y=async()=>{N.value=!0;try{await new Promise(a=>setTimeout(a,1e3)),N.value=!1}catch(a){console.error("获取预订列表失败:",a),f.error("获取预订列表失败"),N.value=!1}},J=a=>{T.value=a,y()},Q=a=>{h.value=a,y()},W=()=>{w.value="add",Object.keys(n).forEach(a=>{n[a]=a==="roomCount"?1:""}),n.dateRange=null,v.value=!0},Y=a=>{w.value="edit",Object.keys(n).forEach(e=>{e==="dateRange"?n[e]=[a.checkInDate,a.checkOutDate]:n[e]=a[e]}),v.value=!0},Z=async()=>{U.value&&await U.value.validate(async a=>{if(a)try{await new Promise(e=>setTimeout(e,1e3)),f.success(w.value==="add"?"预订成功":"修改成功"),v.value=!1,y()}catch(e){console.error("保存预订信息失败:",e),f.error("操作失败")}})},ee=async a=>{try{await M.confirm("确定要确认该预订吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await new Promise(e=>setTimeout(e,1e3)),f.success("预订确认成功"),a.status="confirmed"}catch(e){e!=="cancel"&&(console.error("确认预订失败:",e),f.error("确认失败"))}},le=async a=>{try{await M.confirm("确定要取消该预订吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await new Promise(e=>setTimeout(e,1e3)),f.success("预订取消成功"),a.status="cancelled"}catch(e){e!=="cancel"&&(console.error("取消预订失败:",e),f.error("取消失败"))}},te=a=>{p.roomNumber="",p.deposit=500,p.remarks="",_.value=!0},oe=async()=>{B.value&&await B.value.validate(async a=>{if(a)try{await new Promise(e=>setTimeout(e,1e3)),f.success("入住登记成功"),_.value=!1,y()}catch(e){console.error("入住登记失败:",e),f.error("入住登记失败")}})},ae=a=>{console.log("查看预订详情:",a)};return y(),(a,e)=>{const i=s("el-button"),b=s("el-input"),r=s("el-form-item"),c=s("el-option"),q=s("el-select"),$=s("el-date-picker"),F=s("el-form"),D=s("el-card"),g=s("el-table-column"),ne=s("el-tag"),re=s("el-table"),ue=s("el-pagination"),z=s("el-input-number"),E=s("el-dialog"),se=ie("loading");return k(),P("div",fe,[C("div",be,[e[22]||(e[22]=C("h2",null,"预订管理",-1)),l(i,{type:"primary",onClick:W},{default:o(()=>e[21]||(e[21]=[d("新增预订")])),_:1})]),l(D,{class:"search-card"},{default:o(()=>[l(F,{inline:!0,model:u,class:"search-form"},{default:o(()=>[l(r,{label:"预订号"},{default:o(()=>[l(b,{modelValue:u.bookingNo,"onUpdate:modelValue":e[0]||(e[0]=t=>u.bookingNo=t),placeholder:"请输入预订号",clearable:""},null,8,["modelValue"])]),_:1}),l(r,{label:"客户姓名"},{default:o(()=>[l(b,{modelValue:u.customerName,"onUpdate:modelValue":e[1]||(e[1]=t=>u.customerName=t),placeholder:"请输入客户姓名",clearable:""},null,8,["modelValue"])]),_:1}),l(r,{label:"手机号"},{default:o(()=>[l(b,{modelValue:u.phone,"onUpdate:modelValue":e[2]||(e[2]=t=>u.phone=t),placeholder:"请输入手机号",clearable:""},null,8,["modelValue"])]),_:1}),l(r,{label:"预订状态"},{default:o(()=>[l(q,{modelValue:u.status,"onUpdate:modelValue":e[3]||(e[3]=t=>u.status=t),placeholder:"请选择状态",clearable:""},{default:o(()=>[l(c,{label:"待确认",value:"pending"}),l(c,{label:"已确认",value:"confirmed"}),l(c,{label:"已入住",value:"checked-in"}),l(c,{label:"已取消",value:"cancelled"}),l(c,{label:"已完成",value:"completed"})]),_:1},8,["modelValue"])]),_:1}),l(r,{label:"入住日期"},{default:o(()=>[l($,{modelValue:u.dateRange,"onUpdate:modelValue":e[4]||(e[4]=t=>u.dateRange=t),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])]),_:1}),l(r,null,{default:o(()=>[l(i,{type:"primary",onClick:S},{default:o(()=>e[23]||(e[23]=[d("搜索")])),_:1}),l(i,{onClick:H},{default:o(()=>e[24]||(e[24]=[d("重置")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),l(D,{class:"list-card"},{default:o(()=>[me((k(),V(re,{data:O.value,style:{width:"100%"}},{default:o(()=>[l(g,{prop:"bookingNo",label:"预订号",width:"120"}),l(g,{prop:"customerName",label:"客户姓名"}),l(g,{prop:"phone",label:"手机号"}),l(g,{prop:"roomType",label:"房间类型"}),l(g,{prop:"roomNumber",label:"房间号"}),l(g,{prop:"checkInDate",label:"入住日期"}),l(g,{prop:"checkOutDate",label:"离店日期"}),l(g,{prop:"status",label:"状态"},{default:o(({row:t})=>[l(ne,{type:X(t.status)},{default:o(()=>[d(pe(G(t.status)),1)]),_:2},1032,["type"])]),_:1}),l(g,{label:"操作",width:"250"},{default:o(({row:t})=>[t.status==="pending"?(k(),V(i,{key:0,type:"primary",link:"",onClick:x=>Y(t)},{default:o(()=>e[25]||(e[25]=[d("编辑")])),_:2},1032,["onClick"])):R("",!0),t.status==="pending"?(k(),V(i,{key:1,type:"success",link:"",onClick:x=>ee(t)},{default:o(()=>e[26]||(e[26]=[d("确认")])),_:2},1032,["onClick"])):R("",!0),t.status==="confirmed"?(k(),V(i,{key:2,type:"primary",link:"",onClick:x=>te(t)},{default:o(()=>e[27]||(e[27]=[d("办理入住")])),_:2},1032,["onClick"])):R("",!0),["pending","confirmed"].includes(t.status)?(k(),V(i,{key:3,type:"danger",link:"",onClick:x=>le(t)},{default:o(()=>e[28]||(e[28]=[d("取消")])),_:2},1032,["onClick"])):R("",!0),l(i,{type:"primary",link:"",onClick:x=>ae(t)},{default:o(()=>e[29]||(e[29]=[d("查看")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[se,N.value]]),C("div",ke,[l(ue,{"current-page":h.value,"onUpdate:currentPage":e[5]||(e[5]=t=>h.value=t),"page-size":T.value,"onUpdate:pageSize":e[6]||(e[6]=t=>T.value=t),"page-sizes":[10,20,50,100],total:j.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:J,onCurrentChange:Q},null,8,["current-page","page-size","total"])])]),_:1}),l(E,{title:w.value==="add"?"新增预订":"编辑预订",modelValue:v.value,"onUpdate:modelValue":e[15]||(e[15]=t=>v.value=t),width:"600px"},{footer:o(()=>[C("span",ve,[l(i,{onClick:e[14]||(e[14]=t=>v.value=!1)},{default:o(()=>e[30]||(e[30]=[d("取消")])),_:1}),l(i,{type:"primary",onClick:Z},{default:o(()=>e[31]||(e[31]=[d("确定")])),_:1})])]),default:o(()=>[l(F,{ref_key:"bookingFormRef",ref:U,model:n,rules:A,"label-width":"100px"},{default:o(()=>[l(r,{label:"客户姓名",prop:"customerName"},{default:o(()=>[l(b,{modelValue:n.customerName,"onUpdate:modelValue":e[7]||(e[7]=t=>n.customerName=t)},null,8,["modelValue"])]),_:1}),l(r,{label:"手机号",prop:"phone"},{default:o(()=>[l(b,{modelValue:n.phone,"onUpdate:modelValue":e[8]||(e[8]=t=>n.phone=t)},null,8,["modelValue"])]),_:1}),l(r,{label:"身份证号",prop:"idCard"},{default:o(()=>[l(b,{modelValue:n.idCard,"onUpdate:modelValue":e[9]||(e[9]=t=>n.idCard=t)},null,8,["modelValue"])]),_:1}),l(r,{label:"房间类型",prop:"roomType"},{default:o(()=>[l(q,{modelValue:n.roomType,"onUpdate:modelValue":e[10]||(e[10]=t=>n.roomType=t),placeholder:"请选择房间类型",style:{width:"100%"}},{default:o(()=>[l(c,{label:"标准单人间",value:"single"}),l(c,{label:"标准双人间",value:"double"}),l(c,{label:"豪华套房",value:"suite"})]),_:1},8,["modelValue"])]),_:1}),l(r,{label:"入住日期",prop:"dateRange"},{default:o(()=>[l($,{modelValue:n.dateRange,"onUpdate:modelValue":e[11]||(e[11]=t=>n.dateRange=t),type:"daterange","range-separator":"至","start-placeholder":"入住日期","end-placeholder":"离店日期",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),l(r,{label:"房间数量",prop:"roomCount"},{default:o(()=>[l(z,{modelValue:n.roomCount,"onUpdate:modelValue":e[12]||(e[12]=t=>n.roomCount=t),min:1,max:5},null,8,["modelValue"])]),_:1}),l(r,{label:"特殊要求",prop:"specialRequests"},{default:o(()=>[l(b,{modelValue:n.specialRequests,"onUpdate:modelValue":e[13]||(e[13]=t=>n.specialRequests=t),type:"textarea",rows:"3",placeholder:"请输入特殊要求（如：需要加床、安静房等）"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"]),l(E,{title:"办理入住",modelValue:_.value,"onUpdate:modelValue":e[20]||(e[20]=t=>_.value=t),width:"500px"},{footer:o(()=>[C("span",ye,[l(i,{onClick:e[19]||(e[19]=t=>_.value=!1)},{default:o(()=>e[32]||(e[32]=[d("取消")])),_:1}),l(i,{type:"primary",onClick:oe},{default:o(()=>e[33]||(e[33]=[d("确认入住")])),_:1})])]),default:o(()=>[l(F,{ref_key:"checkInFormRef",ref:B,model:p,rules:K,"label-width":"100px"},{default:o(()=>[l(r,{label:"房间号",prop:"roomNumber"},{default:o(()=>[l(q,{modelValue:p.roomNumber,"onUpdate:modelValue":e[16]||(e[16]=t=>p.roomNumber=t),placeholder:"请选择房间号",style:{width:"100%"}},{default:o(()=>[(k(!0),P(ce,null,ge(L.value,t=>(k(),V(c,{key:t.number,label:t.number,value:t.number},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(r,{label:"押金",prop:"deposit"},{default:o(()=>[l(z,{modelValue:p.deposit,"onUpdate:modelValue":e[17]||(e[17]=t=>p.deposit=t),min:0,step:100},null,8,["modelValue"])]),_:1}),l(r,{label:"备注",prop:"remarks"},{default:o(()=>[l(b,{modelValue:p.remarks,"onUpdate:modelValue":e[18]||(e[18]=t=>p.remarks=t),type:"textarea",rows:"3",placeholder:"请输入备注信息"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},Ne=de(Ve,[["__scopeId","data-v-057a3534"]]);export{Ne as default};
