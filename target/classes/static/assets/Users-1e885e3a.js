import{_ as ee,i as T,d as i,r as n,s as le,o as S,c as ae,b as y,a as l,w as t,E as g,g as d,v as te,f as h,t as q,x as se,y as oe}from"./index-2ad3cb15.js";const re={class:"users-container"},ne={class:"page-header"},ue={class:"pagination-container"},de={class:"dialog-footer"},ie={class:"dialog-footer"},me={__name:"Users",setup(pe){const m=T({username:"",phone:"",status:""}),V=i(!1),B=i([{username:"user1",name:"张三",phone:"13800138000",email:"zhangsan@example.com",createTime:"2024-03-31 10:00:00",status:"active"}]),k=i(1),C=i(10),j=i(100),v=i(!1),b=i("add"),P=i(null),o=T({username:"",name:"",phone:"",email:"",password:""}),N={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],name:[{required:!0,message:"请输入姓名",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度不能小于6位",trigger:"blur"}]},_=i(!1),U=i(null),p=T({userId:"",password:"",confirmPassword:""}),D={password:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,message:"密码长度不能小于6位",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:(s,e,r)=>{e!==p.password?r(new Error("两次输入密码不一致")):r()},trigger:"blur"}]},z=()=>{k.value=1,w()},I=()=>{Object.keys(m).forEach(s=>{m[s]=""}),z()},w=async()=>{V.value=!0;try{await new Promise(s=>setTimeout(s,1e3)),V.value=!1}catch(s){console.error("获取用户列表失败:",s),g.error("获取用户列表失败"),V.value=!1}},O=s=>{C.value=s,w()},L=s=>{k.value=s,w()},M=()=>{b.value="add",Object.keys(o).forEach(s=>{o[s]=""}),v.value=!0},A=s=>{b.value="edit",Object.keys(o).forEach(e=>{e!=="password"&&(o[e]=s[e])}),v.value=!0},G=async()=>{P.value&&await P.value.validate(async s=>{if(s)try{await new Promise(e=>setTimeout(e,1e3)),g.success(b.value==="add"?"添加成功":"修改成功"),v.value=!1,w()}catch(e){console.error("保存用户信息失败:",e),g.error("操作失败")}})},H=s=>{p.userId=s.id,p.password="",p.confirmPassword="",_.value=!0},J=async()=>{U.value&&await U.value.validate(async s=>{if(s)try{await new Promise(e=>setTimeout(e,1e3)),g.success("密码重置成功"),_.value=!1}catch(e){console.error("重置密码失败:",e),g.error("重置密码失败")}})},K=async s=>{try{await oe.confirm(`确定要${s.status==="active"?"禁用":"启用"}该用户吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await new Promise(e=>setTimeout(e,1e3)),g.success(`${s.status==="active"?"禁用":"启用"}成功`),s.status=s.status==="active"?"disabled":"active"}catch(e){e!=="cancel"&&(console.error("修改用户状态失败:",e),g.error("操作失败"))}};return w(),(s,e)=>{const r=n("el-button"),f=n("el-input"),u=n("el-form-item"),E=n("el-option"),Q=n("el-select"),x=n("el-form"),F=n("el-card"),c=n("el-table-column"),W=n("el-tag"),X=n("el-table"),Y=n("el-pagination"),R=n("el-dialog"),Z=le("loading");return S(),ae("div",re,[y("div",ne,[e[17]||(e[17]=y("h2",null,"用户管理",-1)),l(r,{type:"primary",onClick:M},{default:t(()=>e[16]||(e[16]=[d("添加用户")])),_:1})]),l(F,{class:"search-card"},{default:t(()=>[l(x,{inline:!0,model:m,class:"search-form"},{default:t(()=>[l(u,{label:"用户名"},{default:t(()=>[l(f,{modelValue:m.username,"onUpdate:modelValue":e[0]||(e[0]=a=>m.username=a),placeholder:"请输入用户名",clearable:""},null,8,["modelValue"])]),_:1}),l(u,{label:"手机号"},{default:t(()=>[l(f,{modelValue:m.phone,"onUpdate:modelValue":e[1]||(e[1]=a=>m.phone=a),placeholder:"请输入手机号",clearable:""},null,8,["modelValue"])]),_:1}),l(u,{label:"状态"},{default:t(()=>[l(Q,{modelValue:m.status,"onUpdate:modelValue":e[2]||(e[2]=a=>m.status=a),placeholder:"请选择状态",clearable:""},{default:t(()=>[l(E,{label:"正常",value:"active"}),l(E,{label:"禁用",value:"disabled"})]),_:1},8,["modelValue"])]),_:1}),l(u,null,{default:t(()=>[l(r,{type:"primary",onClick:z},{default:t(()=>e[18]||(e[18]=[d("搜索")])),_:1}),l(r,{onClick:I},{default:t(()=>e[19]||(e[19]=[d("重置")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),l(F,{class:"list-card"},{default:t(()=>[te((S(),h(X,{data:B.value,style:{width:"100%"}},{default:t(()=>[l(c,{prop:"username",label:"用户名"}),l(c,{prop:"name",label:"姓名"}),l(c,{prop:"phone",label:"手机号"}),l(c,{prop:"email",label:"邮箱"}),l(c,{prop:"createTime",label:"注册时间"}),l(c,{prop:"status",label:"状态"},{default:t(({row:a})=>[l(W,{type:a.status==="active"?"success":"danger"},{default:t(()=>[d(q(a.status==="active"?"正常":"禁用"),1)]),_:2},1032,["type"])]),_:1}),l(c,{label:"操作",width:"200"},{default:t(({row:a})=>[l(r,{type:"primary",link:"",onClick:$=>A(a)},{default:t(()=>e[20]||(e[20]=[d("编辑")])),_:2},1032,["onClick"]),l(r,{type:"primary",link:"",onClick:$=>H(a)},{default:t(()=>e[21]||(e[21]=[d("重置密码")])),_:2},1032,["onClick"]),l(r,{type:"primary",link:"",onClick:$=>K(a)},{default:t(()=>[d(q(a.status==="active"?"禁用":"启用"),1)]),_:2},1032,["type","onClick"])]),_:1})]),_:1},8,["data"])),[[Z,V.value]]),y("div",ue,[l(Y,{"current-page":k.value,"onUpdate:currentPage":e[3]||(e[3]=a=>k.value=a),"page-size":C.value,"onUpdate:pageSize":e[4]||(e[4]=a=>C.value=a),"page-sizes":[10,20,50,100],total:j.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:O,onCurrentChange:L},null,8,["current-page","page-size","total"])])]),_:1}),l(R,{title:b.value==="add"?"添加用户":"编辑用户",modelValue:v.value,"onUpdate:modelValue":e[11]||(e[11]=a=>v.value=a),width:"500px"},{footer:t(()=>[y("span",de,[l(r,{onClick:e[10]||(e[10]=a=>v.value=!1)},{default:t(()=>e[22]||(e[22]=[d("取消")])),_:1}),l(r,{type:"primary",onClick:G},{default:t(()=>e[23]||(e[23]=[d("确定")])),_:1})])]),default:t(()=>[l(x,{ref_key:"userFormRef",ref:P,model:o,rules:N,"label-width":"100px"},{default:t(()=>[l(u,{label:"用户名",prop:"username"},{default:t(()=>[l(f,{modelValue:o.username,"onUpdate:modelValue":e[5]||(e[5]=a=>o.username=a),disabled:b.value==="edit"},null,8,["modelValue","disabled"])]),_:1}),l(u,{label:"姓名",prop:"name"},{default:t(()=>[l(f,{modelValue:o.name,"onUpdate:modelValue":e[6]||(e[6]=a=>o.name=a)},null,8,["modelValue"])]),_:1}),l(u,{label:"手机号",prop:"phone"},{default:t(()=>[l(f,{modelValue:o.phone,"onUpdate:modelValue":e[7]||(e[7]=a=>o.phone=a)},null,8,["modelValue"])]),_:1}),l(u,{label:"邮箱",prop:"email"},{default:t(()=>[l(f,{modelValue:o.email,"onUpdate:modelValue":e[8]||(e[8]=a=>o.email=a)},null,8,["modelValue"])]),_:1}),b.value==="add"?(S(),h(u,{key:0,label:"密码",prop:"password"},{default:t(()=>[l(f,{modelValue:o.password,"onUpdate:modelValue":e[9]||(e[9]=a=>o.password=a),type:"password","show-password":""},null,8,["modelValue"])]),_:1})):se("",!0)]),_:1},8,["model"])]),_:1},8,["title","modelValue"]),l(R,{title:"重置密码",modelValue:_.value,"onUpdate:modelValue":e[15]||(e[15]=a=>_.value=a),width:"400px"},{footer:t(()=>[y("span",ie,[l(r,{onClick:e[14]||(e[14]=a=>_.value=!1)},{default:t(()=>e[24]||(e[24]=[d("取消")])),_:1}),l(r,{type:"primary",onClick:J},{default:t(()=>e[25]||(e[25]=[d("确定")])),_:1})])]),default:t(()=>[l(x,{ref_key:"resetPasswordFormRef",ref:U,model:p,rules:D,"label-width":"100px"},{default:t(()=>[l(u,{label:"新密码",prop:"password"},{default:t(()=>[l(f,{modelValue:p.password,"onUpdate:modelValue":e[12]||(e[12]=a=>p.password=a),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),l(u,{label:"确认密码",prop:"confirmPassword"},{default:t(()=>[l(f,{modelValue:p.confirmPassword,"onUpdate:modelValue":e[13]||(e[13]=a=>p.confirmPassword=a),type:"password","show-password":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},ce=ee(me,[["__scopeId","data-v-241cfbbd"]]);export{ce as default};
