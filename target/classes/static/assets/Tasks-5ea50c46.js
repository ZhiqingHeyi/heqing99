import{_ as ce,i as M,d as p,D as fe,r as n,s as _e,o as d,c as T,b as i,a as t,w as o,G as ye,H as ge,C as be,I as ve,E as g,g as s,F as I,e as q,v as ke,f as y,t as C,x as B,y as Ve,p as we,q as xe}from"./index-2ad3cb15.js";const Te={class:"tasks-container"},Ce={class:"page-header"},De={class:"stat-content"},Ue={class:"stat-info"},Fe={class:"stat-title"},Ne={class:"stat-count"},Me={class:"card-header"},Ie={class:"header-filter"},qe={class:"dialog-footer"},Be={class:"dialog-footer"},Re={__name:"Tasks",setup(Se){const j=M([{title:"待处理任务",count:8,type:"pending",icon:ye},{title:"进行中任务",count:3,type:"processing",icon:ge},{title:"已完成任务",count:25,type:"completed",icon:be},{title:"高优先级",count:2,type:"high-priority",icon:ve}]),V=p(!1),w=p("all"),R=p([{roomNumber:"301",roomType:"标准双人间",priority:"high",cleaner:"李阿姨",status:"pending",expectedTime:"10:30",notes:"客人即将入住，请优先处理"}]),A=p([{number:"201",type:"标准单人间"},{number:"202",type:"标准单人间"},{number:"301",type:"标准双人间"},{number:"302",type:"标准双人间"}]),G=p([{id:1,name:"张阿姨"},{id:2,name:"李阿姨"},{id:3,name:"王阿姨"}]),O=fe(()=>w.value==="all"?R.value:R.value.filter(a=>a.status===w.value)),b=p(!1),D=p(null),r=M({roomNumber:"",cleaner:"",priority:"medium",expectedTime:null,notes:""}),v=p(!1),U=p(null),u=M({actualDuration:30,cleanItems:[],supplies:[],issues:""}),F=p(null),J={roomNumber:[{required:!0,message:"请选择房间",trigger:"change"}],cleaner:[{required:!0,message:"请选择保洁员",trigger:"change"}],priority:[{required:!0,message:"请选择优先级",trigger:"change"}],expectedTime:[{required:!0,message:"请选择预计完成时间",trigger:"change"}]},K={actualDuration:[{required:!0,message:"请输入实际用时",trigger:"blur"}],cleanItems:[{type:"array",required:!0,message:"请至少选择一个清洁项目",trigger:"change"}],supplies:[{type:"array",required:!0,message:"请至少选择一个物品补充项目",trigger:"change"}]},Q=a=>({pending:"warning",processing:"primary",completed:"success"})[a],W=a=>({pending:"待处理",processing:"进行中",completed:"已完成"})[a],X=a=>({high:"danger",medium:"warning",low:"info"})[a],Y=a=>({high:"高",medium:"中",low:"低"})[a],Z=()=>{Object.keys(r).forEach(a=>{r[a]=a==="priority"?"medium":""}),r.expectedTime=null,b.value=!0},ee=async()=>{D.value&&await D.value.validate(async a=>{if(a)try{await new Promise(e=>setTimeout(e,1e3)),g.success("任务分配成功"),b.value=!1,S()}catch(e){console.error("任务分配失败:",e),g.error("任务分配失败")}})},te=async a=>{try{await Ve.confirm("确定要开始处理该清洁任务吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}),await new Promise(e=>setTimeout(e,1e3)),a.status="processing",g.success("已开始处理任务")}catch(e){e!=="cancel"&&(console.error("开始任务失败:",e),g.error("操作失败"))}},le=a=>{F.value=a,u.actualDuration=30,u.cleanItems=[],u.supplies=[],u.issues="",v.value=!0},oe=async()=>{!U.value||!F.value||await U.value.validate(async a=>{if(a)try{await new Promise(e=>setTimeout(e,1e3)),F.value.status="completed",g.success("清洁任务已完成"),v.value=!1}catch(e){console.error("提交完成信息失败:",e),g.error("操作失败")}})},ae=a=>{console.log("查看任务检查详情:",a)},S=async()=>{V.value=!0;try{await new Promise(a=>setTimeout(a,1e3)),V.value=!1}catch(a){console.error("获取任务列表失败:",a),g.error("获取任务列表失败"),V.value=!1}};return S(),(a,e)=>{const c=n("el-button"),se=n("el-icon"),$=n("el-card"),ne=n("el-col"),re=n("el-row"),x=n("el-radio-button"),ue=n("el-radio-group"),f=n("el-table-column"),P=n("el-tag"),ie=n("el-table"),k=n("el-option"),N=n("el-select"),m=n("el-form-item"),de=n("el-time-picker"),E=n("el-input"),L=n("el-form"),H=n("el-dialog"),pe=n("el-input-number"),_=n("el-checkbox"),h=n("el-checkbox-group"),me=_e("loading");return d(),T("div",Te,[i("div",Ce,[e[15]||(e[15]=i("h2",null,"清洁任务",-1)),t(c,{type:"primary",onClick:Z},{default:o(()=>e[14]||(e[14]=[s("分配任务")])),_:1})]),t(re,{gutter:20,class:"task-stats"},{default:o(()=>[(d(!0),T(I,null,q(j,l=>(d(),y(ne,{span:6,key:l.type},{default:o(()=>[t($,{class:"stat-card","body-style":{padding:"20px"}},{default:o(()=>[i("div",De,[i("div",{class:we(["stat-icon",l.type])},[t(se,null,{default:o(()=>[(d(),y(xe(l.icon)))]),_:2},1024)],2),i("div",Ue,[i("div",Fe,C(l.title),1),i("div",Ne,C(l.count),1)])])]),_:2},1024)]),_:2},1024))),128))]),_:1}),t($,{class:"task-list-card"},{header:o(()=>[i("div",Me,[e[20]||(e[20]=i("div",{class:"header-title"},"任务列表",-1)),i("div",Ie,[t(ue,{modelValue:w.value,"onUpdate:modelValue":e[0]||(e[0]=l=>w.value=l),size:"small"},{default:o(()=>[t(x,{label:"all"},{default:o(()=>e[16]||(e[16]=[s("全部")])),_:1}),t(x,{label:"pending"},{default:o(()=>e[17]||(e[17]=[s("待处理")])),_:1}),t(x,{label:"processing"},{default:o(()=>e[18]||(e[18]=[s("进行中")])),_:1}),t(x,{label:"completed"},{default:o(()=>e[19]||(e[19]=[s("已完成")])),_:1})]),_:1},8,["modelValue"])])])]),default:o(()=>[ke((d(),y(ie,{data:O.value,style:{width:"100%"}},{default:o(()=>[t(f,{prop:"roomNumber",label:"房间号",width:"100"}),t(f,{prop:"roomType",label:"房间类型",width:"120"}),t(f,{prop:"priority",label:"优先级",width:"100"},{default:o(({row:l})=>[t(P,{type:X(l.priority),effect:"dark"},{default:o(()=>[s(C(Y(l.priority)),1)]),_:2},1032,["type"])]),_:1}),t(f,{prop:"cleaner",label:"保洁员"}),t(f,{prop:"status",label:"状态",width:"100"},{default:o(({row:l})=>[t(P,{type:Q(l.status)},{default:o(()=>[s(C(W(l.status)),1)]),_:2},1032,["type"])]),_:1}),t(f,{prop:"expectedTime",label:"预计完成时间",width:"180"}),t(f,{prop:"notes",label:"备注","show-overflow-tooltip":""}),t(f,{label:"操作",width:"200",fixed:"right"},{default:o(({row:l})=>[l.status==="pending"?(d(),y(c,{key:0,type:"primary",link:"",onClick:z=>te(l)},{default:o(()=>e[21]||(e[21]=[s("开始清洁")])),_:2},1032,["onClick"])):B("",!0),l.status==="processing"?(d(),y(c,{key:1,type:"success",link:"",onClick:z=>le(l)},{default:o(()=>e[22]||(e[22]=[s("完成清洁")])),_:2},1032,["onClick"])):B("",!0),l.status==="completed"?(d(),y(c,{key:2,type:"primary",link:"",onClick:z=>ae(l)},{default:o(()=>e[23]||(e[23]=[s("查看检查")])),_:2},1032,["onClick"])):B("",!0)]),_:1})]),_:1},8,["data"])),[[me,V.value]])]),_:1}),t(H,{title:"分配清洁任务",modelValue:b.value,"onUpdate:modelValue":e[7]||(e[7]=l=>b.value=l),width:"500px"},{footer:o(()=>[i("span",qe,[t(c,{onClick:e[6]||(e[6]=l=>b.value=!1)},{default:o(()=>e[24]||(e[24]=[s("取消")])),_:1}),t(c,{type:"primary",onClick:ee},{default:o(()=>e[25]||(e[25]=[s("确定")])),_:1})])]),default:o(()=>[t(L,{ref_key:"taskFormRef",ref:D,model:r,rules:J,"label-width":"100px"},{default:o(()=>[t(m,{label:"房间号",prop:"roomNumber"},{default:o(()=>[t(N,{modelValue:r.roomNumber,"onUpdate:modelValue":e[1]||(e[1]=l=>r.roomNumber=l),placeholder:"请选择房间",style:{width:"100%"}},{default:o(()=>[(d(!0),T(I,null,q(A.value,l=>(d(),y(k,{key:l.number,label:`${l.number} (${l.type})`,value:l.number},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"保洁员",prop:"cleaner"},{default:o(()=>[t(N,{modelValue:r.cleaner,"onUpdate:modelValue":e[2]||(e[2]=l=>r.cleaner=l),placeholder:"请选择保洁员",style:{width:"100%"}},{default:o(()=>[(d(!0),T(I,null,q(G.value,l=>(d(),y(k,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"优先级",prop:"priority"},{default:o(()=>[t(N,{modelValue:r.priority,"onUpdate:modelValue":e[3]||(e[3]=l=>r.priority=l),placeholder:"请选择优先级",style:{width:"100%"}},{default:o(()=>[t(k,{label:"高",value:"high"}),t(k,{label:"中",value:"medium"}),t(k,{label:"低",value:"low"})]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"预计时间",prop:"expectedTime"},{default:o(()=>[t(de,{modelValue:r.expectedTime,"onUpdate:modelValue":e[4]||(e[4]=l=>r.expectedTime=l),format:"HH:mm",placeholder:"选择时间",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(m,{label:"备注",prop:"notes"},{default:o(()=>[t(E,{modelValue:r.notes,"onUpdate:modelValue":e[5]||(e[5]=l=>r.notes=l),type:"textarea",rows:"3",placeholder:"请输入任务备注"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),t(H,{title:"完成清洁确认",modelValue:v.value,"onUpdate:modelValue":e[13]||(e[13]=l=>v.value=l),width:"500px"},{footer:o(()=>[i("span",Be,[t(c,{onClick:e[12]||(e[12]=l=>v.value=!1)},{default:o(()=>e[35]||(e[35]=[s("取消")])),_:1}),t(c,{type:"primary",onClick:oe},{default:o(()=>e[36]||(e[36]=[s("确认完成")])),_:1})])]),default:o(()=>[t(L,{ref_key:"completeFormRef",ref:U,model:u,rules:K,"label-width":"100px"},{default:o(()=>[t(m,{label:"实际用时",prop:"actualDuration"},{default:o(()=>[t(pe,{modelValue:u.actualDuration,"onUpdate:modelValue":e[8]||(e[8]=l=>u.actualDuration=l),min:5,max:120,step:5},null,8,["modelValue"]),e[26]||(e[26]=i("span",{class:"unit-text"},"分钟",-1))]),_:1}),t(m,{label:"清洁项目",prop:"cleanItems"},{default:o(()=>[t(h,{modelValue:u.cleanItems,"onUpdate:modelValue":e[9]||(e[9]=l=>u.cleanItems=l)},{default:o(()=>[t(_,{label:"bedding"},{default:o(()=>e[27]||(e[27]=[s("床品更换")])),_:1}),t(_,{label:"bathroom"},{default:o(()=>e[28]||(e[28]=[s("浴室清洁")])),_:1}),t(_,{label:"floor"},{default:o(()=>e[29]||(e[29]=[s("地面清洁")])),_:1}),t(_,{label:"furniture"},{default:o(()=>e[30]||(e[30]=[s("家具除尘")])),_:1}),t(_,{label:"garbage"},{default:o(()=>e[31]||(e[31]=[s("垃圾清理")])),_:1})]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"物品补充",prop:"supplies"},{default:o(()=>[t(h,{modelValue:u.supplies,"onUpdate:modelValue":e[10]||(e[10]=l=>u.supplies=l)},{default:o(()=>[t(_,{label:"toiletries"},{default:o(()=>e[32]||(e[32]=[s("洗漱用品")])),_:1}),t(_,{label:"towels"},{default:o(()=>e[33]||(e[33]=[s("毛巾浴巾")])),_:1}),t(_,{label:"water"},{default:o(()=>e[34]||(e[34]=[s("饮用水")])),_:1})]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"特殊情况",prop:"issues"},{default:o(()=>[t(E,{modelValue:u.issues,"onUpdate:modelValue":e[11]||(e[11]=l=>u.issues=l),type:"textarea",rows:"3",placeholder:"请记录房间内发现的任何问题或特殊情况"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},Pe=ce(Re,[["__scopeId","data-v-8916600a"]]);export{Pe as default};
